---
title: "lab09"
author: 'Ethan Ashley (PID: A15939817)'
date: "2025-10-29"
output: pdf_document
toc: true
---

# Introduction to PDB

Importing the PDB statistics data file.
```{r}
#Installing the 'READR' Package
library(readr)
```


```{r}
#import data and convert into integer format for numeric operations
PDB_stats <- read_csv("Data Export Summary.csv")

#PDB_stats <- read.csv("Data Export Summary.csv", row.names = 1)
#PDB_stats <- lapply(PDB_stats, gsub, pattern = ',', replacement = '')
#PDB_stats <- lapply(PDB_stats, as.integer)
```

**Q1: What percentage of structures in the PDB are solved by X-Ray and Electron Microscopy.**

81.4% of the structures in the PDB are solved by X-ray 
12.3% of the strucutres in the PDB are solved by electron microscopy.

```{r}
total_xray <- sum(PDB_stats$`X-ray`)
total_EM <- sum(PDB_stats$EM)
total_entries <- sum(PDB_stats$Total)

total_xray/total_entries
total_EM/total_entries

```

**Q2: What proportion of structures in the PDB are protein?**

86.0% of the structures in the PDB are protein.

```{r}
PDB_stats$Total[1]/sum(PDB_stats$Total)


```

**Q3: Type HIV in the PDB website search box on the home page and determine how many HIV-1 protease structures are in the current PDB?**


**Q3: Make a bar plot overview of Molecular type**

```{r}
library(ggplot2)

ggplot(PDB_stats) + aes(reorder(`Molecular Type`, -Total), Total, fill=PDB_stats$Total) + geom_col()

#ggplot(PDB_stats) + aes(reorder(`Molecular Type`, -Total), Total) + geom_bar(stat = "identity", position="stack")
```


# Visualizing structure data with the Mol* viewer

The Mol* viewer is embeded in the website of many bioinformatics websites, like PDB

We will use it on the https://molstar.org/ website

Let's look at the x-ray crystal structure of the HIV-1 protease bound with the drug indinavir (PDB ID: 1HSG)

Figures or images can be inserted using markdown format.

![](1HSG.png)


Updated image of the protease with the spacefill model representation of the drug

![](1HSG_modified.png)


**Q4: Water molecules normally have 3 atoms. Why do we see just one atom per water molecule in this structure?**

We chose to display the water molecules in a way that is less obtrusive when observing the rest of the structure.

**Q5: There is a critical “conserved” water molecule in the binding site. Can you identify this water molecule? What residue number does this water molecule have**

This water molecule has residue number 308.

**Q6: Generate and save a figure clearly showing the two distinct chains of HIV-protease along with the ligand. You might also consider showing the catalytic residues ASP 25 in each chain and the critical water (we recommend “Ball & Stick” for these side-chains). Add this figure to your Quarto document.**

![](1HSG_conserved_water.png)


# Bio3D package for structural bioinformatics

We can use the bio3d package to read and analyze biomolecular data in R.

```{r}
library(bio3d)

hiv <- read.pdb("1HSG")

hiv
```


**Q7: How many amino acid residues are there in this pdb object?**

There are 128 residues in this pdb object

**Q8: Name one of the two non-protein residues?**

HOH

**Q9: How many protein chains are in this structure? **

2, chains A and B.

Let's get the sequence

```{r}
pdbseq(hiv)
```
Let's trim to chain A and get just it's sequence:

```{r}
chainA <- trim.pdb(hiv, chain = "A")
chainA.seq <- pdbseq(chainA)
```

Let's blast 

```{r blast_hiv, cache=TRUE}
#These results will be cached so that it does not re-do the blast search every time

blast <- blast.pdb(chainA.seq)
```
Plot a quick overview of blast results

```{r}
hits <- plot(blast)
```
# Prediciton of functional motions

We can run a normal mode analysis (NMA) to predict large scale motions/flexibility/dynamics of any biomolecule that we can read into R.

Let's look at ADK chain A

```{r}
adk <- read.pdb("1ake")
adk_A <- trim.pdb(adk, chain="A")
```

```{r}
m <- nma(adk_A)

plot(m)
```

Let's write out a "trajectory" of predicted motion that we can open in Mol*

```{r}
mktrj(m, file="adk_nma.pdb")
```


# Play with 3D viewing in R

We can use the new **bio3dview** package, which is not yet on CRAN, to render interactive 3D views in R and HTML output reports.

To install from GitHub we can use the **pak* package

```{r}
#pak::pak("bioboot/bio3dview")

```


# Comparative Analysis of Protein Structures

Starting with sequence or structure ID (accession number) let's run a complete analysis pipeline.

```{r}
library(bio3d)

id <- "1ake_A"

aa <- get.seq(id)

aa
```
```{r, cahce=TRUE}
blast <- blast.pdb(aa)
hits <- plot(blast)
```

```{r}
hits$pdb.id
```

```{r}
# Download releated PDB files
files <- get.pdb(hits$pdb.id, path="pdbs", split=TRUE, gzip=TRUE)
```

```{r}
# Align releated PDBs
#library(BiocManager)
pdbs <- pdbaln(files, fit = TRUE, exefile="msa")
```

```{r}
# Perform PCA
pc.xray <- pca(pdbs)
plot(pc.xray)
```

```{r}
# Calculate RMSD
rd <- rmsd(pdbs)

# Structure-based clustering
hc.rd <- hclust(dist(rd))
grps.rd <- cutree(hc.rd, k=3)

plot(pc.xray, 1:2, col="grey50", bg=grps.rd, pch=21, cex=1)
```

```{r}
mktrj(pc.xray, file="pca_results.pdb")
```

```{r}
library(bio3dview)

#view.pca(pc.xray)
```

